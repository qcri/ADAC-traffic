---------------------------------------
Setting: Training BCQ, Env: gharaffa-NTFT20, Seed: 20
---------------------------------------
State dim=68 and num_actions=11
BCQ environment with args:  Namespace(env='gharaffa-NTFT20', seed=20, buffer_name='stationary-NTFT20', max_timesteps=100000, offline_algo='BCQ', BCQ_threshold=0.3, low_noise_p=0.2, rand_action_p=0.2, train_behavioral=False, generate_buffer=False, generate_buffer_with_policy=False, evaluate_only=False, no_termination=False, sm_threshold=5.0, mm_threshold=1.0, num_heads=4, num_convex_combos=4, id_tokens='~dac-r0.5-sample-2-nmode0.8-nostate', dac_configs=1)
Replay Buffer loaded with 8640 elements.
Replay Buffer loaded with 8640 elements.
Launching final eval:
0it [00:00, ?it/s]2627it [00:00, 26268.15it/s]5512it [00:00, 26244.16it/s]8137it [00:00, 24112.81it/s]8492it [00:00, 24262.85it/s]
Detected core states: 8266
0it [00:00, ?it/s]2101it [00:00, 21009.42it/s]4406it [00:00, 20975.68it/s]6504it [00:00, 20089.09it/s]8492it [00:00, 20711.94it/s]
df after core index:                                                   state  ...  core_index
2103  (20.0, 20.0, 20.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0....  ...        7509
5433  (20.0, 20.0, 20.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6....  ...        7484
8214  (1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...  ...        1141

[3 rows x 5 columns]
Indexing core states ANN
0it [00:00, ?it/s]1496it [00:00, 13600.04it/s]3225it [00:00, 14846.28it/s]4829it [00:00, 15363.10it/s]6563it [00:00, 15525.30it/s]8166it [00:00, 15699.23it/s]8492it [00:00, 15440.05it/s]
Finding diameter of the core states
0it [00:00, ?it/s]1513it [00:00, 14604.78it/s]2974it [00:00, 14604.52it/s]4435it [00:00, 12362.47it/s]5705it [00:00, 10604.23it/s]6808it [00:00, 10417.89it/s]7875it [00:00, 9907.94it/s] 8492it [00:00, 10563.61it/s]
The diameter = 55.09083408335728 from a core set of size: 8491
0it [00:00, ?it/s]13it [00:00, 129.28it/s]28it [00:00, 133.85it/s]42it [00:00, 130.66it/s]56it [00:00, 129.30it/s]69it [00:00, 129.54it/s]84it [00:00, 131.98it/s]98it [00:00, 130.41it/s]113it [00:00, 132.45it/s]127it [00:00, 127.08it/s]140it [00:01, 124.37it/s]153it [00:01, 125.97it/s]166it [00:01, 123.57it/s]179it [00:01, 115.50it/s]191it [00:01, 113.63it/s]203it [00:01, 112.29it/s]215it [00:01, 111.34it/s]227it [00:01, 107.76it/s]240it [00:01, 113.84it/s]253it [00:02, 118.38it/s]267it [00:02, 121.10it/s]280it [00:02, 123.63it/s]293it [00:02, 125.47it/s]306it [00:02, 126.79it/s]320it [00:02, 126.94it/s]335it [00:02, 129.87it/s]349it [00:02, 129.07it/s]364it [00:02, 131.29it/s]378it [00:03, 130.07it/s]392it [00:03, 125.77it/s]405it [00:03, 126.94it/s]418it [00:03, 124.29it/s]431it [00:03, 122.44it/s]444it [00:03, 121.16it/s]458it [00:03, 123.00it/s]471it [00:03, 124.97it/s]484it [00:03, 126.41it/s]498it [00:04, 130.35it/s]512it [00:04, 129.39it/s]525it [00:04, 129.57it/s]538it [00:04, 129.69it/s]552it [00:04, 128.93it/s]565it [00:04, 129.24it/s]579it [00:04, 128.63it/s]592it [00:04, 123.67it/s]605it [00:04, 120.25it/s]618it [00:04, 119.63it/s]632it [00:05, 125.33it/s]646it [00:05, 125.93it/s]659it [00:05, 123.57it/s]672it [00:05, 120.38it/s]685it [00:05, 119.72it/s]700it [00:05, 121.40it/s]713it [00:05, 119.81it/s]726it [00:05, 122.60it/s]739it [00:05, 124.67it/s]752it [00:06, 126.19it/s]765it [00:06, 127.28it/s]778it [00:06, 128.07it/s]791it [00:06, 124.94it/s]804it [00:06, 126.40it/s]817it [00:06, 127.44it/s]831it [00:06, 131.13it/s]845it [00:06, 130.34it/s]859it [00:06, 127.76it/s]872it [00:06, 125.11it/s]885it [00:07, 122.96it/s]899it [00:07, 124.26it/s]915it [00:07, 130.67it/s]929it [00:07, 126.19it/s]942it [00:07, 127.24it/s]955it [00:07, 128.02it/s]968it [00:07, 124.99it/s]983it [00:07, 128.46it/s]997it [00:07, 128.10it/s]1011it [00:08, 127.85it/s]1025it [00:08, 130.30it/s]1039it [00:08, 129.78it/s]1052it [00:08, 126.24it/s]1065it [00:08, 127.29it/s]1078it [00:08, 124.46it/s]1092it [00:08, 128.88it/s]1105it [00:08, 129.18it/s]1119it [00:08, 132.34it/s]1133it [00:09, 117.28it/s]1146it [00:09, 120.69it/s]1159it [00:09, 119.93it/s]1172it [00:09, 119.40it/s]1185it [00:09, 119.02it/s]1197it [00:09, 113.41it/s]1209it [00:09, 111.67it/s]1221it [00:09, 113.95it/s]1233it [00:09, 115.65it/s]1246it [00:10, 119.76it/s]1259it [00:10, 119.26it/s]1271it [00:10, 119.45it/s]1284it [00:10, 122.50it/s]1297it [00:10, 124.69it/s]1310it [00:10, 126.24it/s]1323it [00:10, 123.67it/s]1336it [00:10, 125.49it/s]1349it [00:10, 126.80it/s]1363it [00:10, 130.69it/s]1377it [00:11, 122.52it/s]1390it [00:11, 124.60it/s]1403it [00:11, 126.13it/s]1416it [00:11, 123.65it/s]1429it [00:11, 125.45it/s]1442it [00:11, 126.76it/s]1455it [00:11, 124.05it/s]1468it [00:11, 125.76it/s]1481it [00:11, 126.99it/s]1495it [00:11, 130.81it/s]1509it [00:12, 129.68it/s]1523it [00:12, 132.67it/s]1537it [00:12, 134.81it/s]1551it [00:12, 132.41it/s]1565it [00:12, 126.21it/s]1578it [00:12, 123.16it/s]1591it [00:12, 125.07it/s]1604it [00:12, 122.97it/s]1617it [00:12, 123.10it/s]1630it [00:13, 122.37it/s]1643it [00:13, 124.53it/s]1657it [00:13, 128.99it/s]1670it [00:13, 129.28it/s]1684it [00:13, 132.42it/s]1698it [00:13, 134.65it/s]1712it [00:13, 132.30it/s]1726it [00:13, 134.53it/s]1740it [00:13, 136.12it/s]1754it [00:13, 133.30it/s]1768it [00:14, 135.23it/s]1782it [00:14, 136.62it/s]1796it [00:14, 133.66it/s]1810it [00:14, 135.48it/s]1824it [00:14, 136.79it/s]1838it [00:14, 137.73it/s]1852it [00:14, 134.39it/s]1866it [00:14, 136.01it/s]1880it [00:14, 137.18it/s]1894it [00:15, 138.00it/s]1908it [00:15, 135.72it/s]1922it [00:15, 133.07it/s]1937it [00:15, 134.09it/s]1951it [00:15, 132.00it/s]1965it [00:15, 130.56it/s]1981it [00:15, 131.45it/s]1995it [00:15, 133.82it/s]2009it [00:15, 135.57it/s]2024it [00:15, 135.81it/s]2039it [00:16, 135.99it/s]2054it [00:16, 136.10it/s]2069it [00:16, 136.18it/s]2083it [00:16, 133.49it/s]2097it [00:16, 135.32it/s]2112it [00:16, 135.64it/s]2127it [00:16, 135.86it/s]2141it [00:16, 129.69it/s]2155it [00:17, 113.65it/s]2167it [00:17, 109.70it/s]2179it [00:17, 112.34it/s]2191it [00:17, 111.41it/s]2203it [00:17, 113.74it/s]2215it [00:17, 115.49it/s]2227it [00:17, 116.78it/s]2240it [00:17, 117.21it/s]2252it [00:17, 114.72it/s]2264it [00:17, 113.01it/s]2276it [00:18, 114.99it/s]2289it [00:18, 115.97it/s]2302it [00:18, 119.98it/s]2316it [00:18, 122.24it/s]2329it [00:18, 124.47it/s]2342it [00:18, 122.51it/s]2355it [00:18, 121.18it/s]2368it [00:18, 98.12it/s] 2379it [00:19, 72.47it/s]2388it [00:19, 74.35it/s]2397it [00:19, 77.10it/s]2409it [00:19, 86.02it/s]2421it [00:19, 92.76it/s]2431it [00:19, 94.64it/s]2443it [00:19, 99.35it/s]2455it [00:19, 103.04it/s]2466it [00:20, 104.10it/s]2477it [00:20, 104.88it/s]2490it [00:20, 109.55it/s]2503it [00:20, 115.38it/s]2515it [00:20, 115.38it/s]2529it [00:20, 120.43it/s]2542it [00:20, 121.79it/s]2556it [00:20, 124.55it/s]2570it [00:20, 126.81it/s]2584it [00:20, 130.09it/s]2598it [00:21, 132.97it/s]2612it [00:21, 131.18it/s]2627it [00:21, 132.79it/s]2641it [00:21, 134.75it/s]2655it [00:21, 133.99it/s]2669it [00:21, 134.21it/s]2684it [00:21, 134.88it/s]2698it [00:21, 136.15it/s]2712it [00:21, 133.57it/s]2726it [00:22, 135.42it/s]2740it [00:22, 136.74it/s]2754it [00:22, 133.77it/s]2768it [00:22, 126.63it/s]2782it [00:22, 128.57it/s]2796it [00:22, 130.44it/s]2810it [00:22, 131.50it/s]2824it [00:22, 132.42it/s]2839it [00:22, 135.79it/s]2853it [00:22, 133.15it/s]2867it [00:23, 133.59it/s]2881it [00:23, 134.66it/s]2895it [00:23, 135.42it/s]2909it [00:23, 133.72it/s]2924it [00:23, 135.22it/s]2938it [00:23, 136.51it/s]2952it [00:23, 130.41it/s]2966it [00:23, 125.66it/s]2979it [00:23, 118.63it/s]2991it [00:24, 116.49it/s]3005it [00:24, 121.26it/s]3018it [00:24, 120.44it/s]3031it [00:24, 118.80it/s]3045it [00:24, 123.66it/s]3060it [00:24, 129.17it/s]3073it [00:24, 129.40it/s]3087it [00:24, 132.47it/s]3102it [00:24, 133.68it/s]3116it [00:25, 135.51it/s]3130it [00:25, 132.94it/s]3144it [00:25, 131.19it/s]3158it [00:25, 114.97it/s]3170it [00:25, 113.33it/s]3182it [00:25, 109.29it/s]3195it [00:25, 114.78it/s]3207it [00:25, 110.16it/s]3220it [00:25, 115.54it/s]3234it [00:26, 119.04it/s]3248it [00:26, 121.51it/s]3262it [00:26, 123.23it/s]3275it [00:26, 121.72it/s]3288it [00:26, 124.04it/s]3301it [00:26, 125.74it/s]3316it [00:26, 129.03it/s]3330it [00:26, 128.49it/s]3343it [00:26, 128.81it/s]3358it [00:27, 131.26it/s]3372it [00:27, 122.08it/s]3385it [00:27, 113.55it/s]3397it [00:27, 115.24it/s]3410it [00:27, 119.15it/s]3424it [00:27, 121.74it/s]3437it [00:27, 119.23it/s]3450it [00:27, 117.07it/s]3463it [00:27, 117.39it/s]3475it [00:28, 118.10it/s]3487it [00:28, 115.37it/s]3499it [00:28, 110.36it/s]3511it [00:28, 109.98it/s]3525it [00:28, 115.12it/s]3540it [00:28, 121.58it/s]3555it [00:28, 125.93it/s]3570it [00:28, 129.09it/s]3585it [00:28, 131.22it/s]3599it [00:29, 130.08it/s]3613it [00:29, 129.17it/s]3627it [00:29, 132.20it/s]3641it [00:29, 130.77it/s]3655it [00:29, 129.71it/s]3669it [00:29, 132.48it/s]3684it [00:29, 133.84it/s]3699it [00:29, 134.61it/s]3713it [00:29, 132.41it/s]3727it [00:30, 134.55it/s]3741it [00:30, 132.31it/s]3756it [00:30, 133.69it/s]3770it [00:30, 135.48it/s]3784it [00:30, 132.95it/s]3798it [00:30, 134.91it/s]3812it [00:30, 136.38it/s]3827it [00:30, 136.39it/s]3842it [00:30, 136.38it/s]3856it [00:30, 133.59it/s]3870it [00:31, 131.67it/s]3884it [00:31, 134.03it/s]3898it [00:31, 134.03it/s]3912it [00:31, 124.53it/s]3926it [00:31, 126.01it/s]3940it [00:31, 128.12it/s]3955it [00:31, 131.20it/s]3969it [00:31, 133.68it/s]3983it [00:31, 129.89it/s]3997it [00:32, 129.68it/s]4011it [00:32, 128.94it/s]4024it [00:32, 128.96it/s]4037it [00:32, 125.14it/s]4050it [00:32, 120.29it/s]4064it [00:32, 125.75it/s]4077it [00:32, 126.94it/s]4090it [00:32, 127.81it/s]4104it [00:32, 131.36it/s]4118it [00:33, 126.85it/s]4132it [00:33, 130.58it/s]4146it [00:33, 125.93it/s]4159it [00:33, 123.59it/s]4172it [00:33, 121.95it/s]4185it [00:33, 120.81it/s]4198it [00:33, 120.01it/s]4211it [00:33, 113.88it/s]4224it [00:33, 117.21it/s]4236it [00:34, 111.77it/s]4248it [00:34, 114.00it/s]4261it [00:34, 118.48it/s]4274it [00:34, 121.76it/s]4287it [00:34, 117.33it/s]4300it [00:34, 120.88it/s]4313it [00:34, 123.48it/s]4326it [00:34, 118.47it/s]4338it [00:34, 115.63it/s]4350it [00:34, 116.84it/s]4363it [00:35, 120.60it/s]4376it [00:35, 110.46it/s]4388it [00:35, 104.53it/s]4399it [00:35, 93.44it/s] 4410it [00:35, 96.60it/s]4423it [00:35, 105.31it/s]4436it [00:35, 110.12it/s]4449it [00:35, 115.29it/s]4463it [00:36, 119.89it/s]4476it [00:36, 117.91it/s]4488it [00:36, 116.54it/s]4501it [00:36, 117.68it/s]4513it [00:36, 116.36it/s]4525it [00:36, 116.08it/s]4537it [00:36, 115.22it/s]4550it [00:36, 118.44it/s]4564it [00:36, 123.25it/s]4578it [00:36, 125.91it/s]4592it [00:37, 128.13it/s]4606it [00:37, 130.44it/s]4620it [00:37, 131.31it/s]4634it [00:37, 129.69it/s]4649it [00:37, 133.87it/s]4663it [00:37, 131.84it/s]4677it [00:37, 133.27it/s]4692it [00:37, 135.36it/s]4706it [00:37, 135.63it/s]4720it [00:38, 135.71it/s]4734it [00:38, 135.78it/s]4749it [00:38, 136.23it/s]4763it [00:38, 137.32it/s]4777it [00:38, 133.13it/s]4791it [00:38, 132.07it/s]4805it [00:38, 133.19it/s]4821it [00:38, 137.19it/s]4835it [00:38, 137.98it/s]4849it [00:38, 138.55it/s]4863it [00:39, 138.96it/s]4877it [00:39, 139.25it/s]4891it [00:39, 135.45it/s]4905it [00:39, 136.75it/s]4919it [00:39, 137.69it/s]4933it [00:39, 138.24it/s]4947it [00:39, 138.75it/s]4961it [00:39, 135.08it/s]4975it [00:39, 136.50it/s]4989it [00:39, 137.52it/s]5003it [00:40, 138.24it/s]5017it [00:40, 138.75it/s]5031it [00:40, 135.95it/s]5045it [00:40, 121.12it/s]5059it [00:40, 124.54it/s]5073it [00:40, 127.90it/s]5087it [00:40, 131.30it/s]5101it [00:40, 130.04it/s]5115it [00:40, 132.87it/s]5129it [00:41, 131.13it/s]5143it [00:41, 133.66it/s]5157it [00:41, 128.05it/s]5170it [00:41, 128.59it/s]5184it [00:41, 131.85it/s]5198it [00:41, 134.21it/s]5212it [00:41, 132.02it/s]5226it [00:41, 130.53it/s]5240it [00:41, 129.51it/s]5253it [00:42, 129.64it/s]5266it [00:42, 129.73it/s]5280it [00:42, 132.72it/s]5294it [00:42, 127.35it/s]5307it [00:42, 128.09it/s]5321it [00:42, 131.51it/s]5335it [00:42, 130.17it/s]5349it [00:42, 133.00it/s]5363it [00:42, 116.03it/s]5376it [00:43, 116.64it/s]5389it [00:43, 120.23it/s]5402it [00:43, 122.81it/s]5416it [00:43, 124.63it/s]5429it [00:43, 126.15it/s]5443it [00:43, 126.50it/s]5456it [00:43, 123.96it/s]5469it [00:43, 122.20it/s]5482it [00:43, 119.50it/s]5494it [00:43, 113.00it/s]5508it [00:44, 117.19it/s]5521it [00:44, 117.66it/s]5533it [00:44, 115.12it/s]5545it [00:44, 112.39it/s]5557it [00:44, 114.49it/s]5571it [00:44, 116.08it/s]5583it [00:44, 116.34it/s]5595it [00:44, 117.23it/s]5609it [00:44, 123.67it/s]5623it [00:45, 128.41it/s]5637it [00:45, 131.81it/s]5651it [00:45, 134.22it/s]5665it [00:45, 135.92it/s]5679it [00:45, 133.15it/s]5693it [00:45, 135.14it/s]5707it [00:45, 132.64it/s]5721it [00:45, 134.76it/s]5735it [00:45, 132.40it/s]5749it [00:45, 134.59it/s]5763it [00:46, 136.07it/s]5777it [00:46, 133.38it/s]5791it [00:46, 135.29it/s]5805it [00:46, 136.64it/s]5820it [00:46, 136.56it/s]5834it [00:46, 133.66it/s]5848it [00:46, 128.10it/s]5861it [00:46, 128.62it/s]5874it [00:46, 129.00it/s]5888it [00:47, 132.18it/s]5902it [00:47, 130.63it/s]5916it [00:47, 133.33it/s]5930it [00:47, 135.25it/s]5944it [00:47, 132.72it/s]5958it [00:47, 134.82it/s]5972it [00:47, 136.32it/s]5986it [00:47, 137.39it/s]6000it [00:47, 135.71it/s]6014it [00:47, 136.57it/s]6028it [00:48, 136.37it/s]6042it [00:48, 137.44it/s]6056it [00:48, 138.20it/s]6070it [00:48, 137.11it/s]6084it [00:48, 134.38it/s]6098it [00:48, 134.45it/s]6112it [00:48, 132.97it/s]6126it [00:48, 133.84it/s]6140it [00:48, 134.46it/s]6154it [00:49, 134.12it/s]6168it [00:49, 135.04it/s]6182it [00:49, 134.92it/s]6196it [00:49, 132.53it/s]6210it [00:49, 125.62it/s]6223it [00:49, 120.16it/s]6236it [00:49, 108.08it/s]6248it [00:49, 110.01it/s]6260it [00:49, 106.98it/s]6271it [00:50, 104.19it/s]6282it [00:50, 105.18it/s]6293it [00:50, 101.74it/s]6305it [00:50, 106.44it/s]6316it [00:50, 103.11it/s]6328it [00:50, 107.79it/s]6341it [00:50, 112.50it/s]6353it [00:50, 114.64it/s]6365it [00:50, 114.54it/s]6377it [00:51, 112.53it/s]6391it [00:51, 117.70it/s]6403it [00:51, 115.07it/s]6415it [00:51, 114.52it/s]6427it [00:51, 113.49it/s]6440it [00:51, 117.86it/s]6454it [00:51, 121.79it/s]6467it [00:51, 119.67it/s]6480it [00:51, 120.22it/s]6493it [00:51, 120.94it/s]6507it [00:52, 124.25it/s]6521it [00:52, 127.66it/s]6535it [00:52, 128.99it/s]6548it [00:52, 127.44it/s]6561it [00:52, 128.18it/s]6575it [00:52, 130.11it/s]6589it [00:52, 127.78it/s]6602it [00:52, 126.96it/s]6615it [00:52, 127.47it/s]6628it [00:53, 126.01it/s]6642it [00:53, 128.21it/s]6656it [00:53, 131.62it/s]6670it [00:53, 120.65it/s]6683it [00:53, 111.89it/s]6695it [00:53, 110.54it/s]6707it [00:53, 110.41it/s]6720it [00:53, 115.71it/s]6732it [00:53, 108.44it/s]6744it [00:54, 98.53it/s] 6757it [00:54, 103.89it/s]6768it [00:54, 104.94it/s]6780it [00:54, 108.14it/s]6793it [00:54, 112.95it/s]6805it [00:54, 107.37it/s]6817it [00:54, 109.63it/s]6829it [00:54, 111.89it/s]6842it [00:54, 116.69it/s]6856it [00:55, 122.69it/s]6870it [00:55, 126.25it/s]6883it [00:55, 123.05it/s]6896it [00:55, 120.22it/s]6909it [00:55, 116.72it/s]6922it [00:55, 119.40it/s]6936it [00:55, 123.81it/s]6949it [00:55, 121.09it/s]6962it [00:55, 118.27it/s]6975it [00:56, 119.54it/s]6987it [00:56, 114.52it/s]6999it [00:56, 115.72it/s]7012it [00:56, 118.42it/s]7024it [00:56, 118.87it/s]7037it [00:56, 120.70it/s]7050it [00:56, 122.51it/s]7064it [00:56, 125.77it/s]7078it [00:56, 128.42it/s]7092it [00:56, 130.65it/s]7106it [00:57, 130.91it/s]7120it [00:57, 131.13it/s]7134it [00:57, 133.31it/s]7148it [00:57, 125.38it/s]7161it [00:57, 126.67it/s]7174it [00:57, 122.39it/s]7188it [00:57, 125.92it/s]7202it [00:57, 127.74it/s]7215it [00:57, 128.31it/s]7229it [00:58, 130.93it/s]7243it [00:58, 126.92it/s]7256it [00:58, 124.55it/s]7269it [00:58, 111.29it/s]7281it [00:58, 106.58it/s]7294it [00:58, 112.39it/s]7308it [00:58, 117.47it/s]7320it [00:58, 110.28it/s]7333it [00:58, 115.26it/s]7346it [00:59, 119.01it/s]7360it [00:59, 122.86it/s]7373it [00:59, 118.49it/s]7385it [00:59, 116.32it/s]7398it [00:59, 119.48it/s]7412it [00:59, 124.26it/s]7425it [00:59, 123.08it/s]7438it [00:59, 122.26it/s]7452it [00:59, 125.53it/s]7465it [01:00, 125.02it/s]7478it [01:00, 118.61it/s]7490it [01:00, 118.33it/s]7503it [01:00, 118.62it/s]7515it [01:00, 117.35it/s]7528it [01:00, 118.92it/s]7541it [01:00, 120.71it/s]7554it [01:00, 123.03it/s]7567it [01:00, 122.56it/s]7580it [01:01, 120.29it/s]7593it [01:01, 116.42it/s]7606it [01:01, 118.87it/s]7620it [01:01, 120.19it/s]7633it [01:01, 117.19it/s]7647it [01:01, 122.13it/s]7660it [01:01, 124.16it/s]7674it [01:01, 127.23it/s]7688it [01:01, 128.99it/s]7702it [01:01, 130.65it/s]7716it [01:02, 131.08it/s]7730it [01:02, 131.65it/s]7744it [01:02, 131.58it/s]7758it [01:02, 129.89it/s]7772it [01:02, 131.28it/s]7786it [01:02, 132.64it/s]7800it [01:02, 132.47it/s]7814it [01:02, 133.11it/s]7828it [01:02, 132.04it/s]7842it [01:03, 131.31it/s]7856it [01:03, 130.80it/s]7870it [01:03, 131.46it/s]7884it [01:03, 126.98it/s]7897it [01:03, 127.12it/s]7911it [01:03, 128.95it/s]7924it [01:03, 128.15it/s]7937it [01:03, 128.31it/s]7950it [01:03, 128.43it/s]7964it [01:04, 129.54it/s]7977it [01:04, 127.97it/s]7991it [01:04, 128.85it/s]8005it [01:04, 131.36it/s]8019it [01:04, 132.49it/s]8033it [01:04, 134.14it/s]8048it [01:04, 135.07it/s]8062it [01:04, 134.78it/s]8076it [01:04, 133.79it/s]8090it [01:04, 125.50it/s]8103it [01:05, 126.36it/s]8116it [01:05, 121.46it/s]8129it [01:05, 121.46it/s]8143it [01:05, 125.09it/s]8156it [01:05, 122.81it/s]8169it [01:05, 117.83it/s]8183it [01:05, 121.27it/s]8196it [01:05, 117.30it/s]8209it [01:05, 119.75it/s]8222it [01:06, 121.64it/s]8235it [01:06, 122.31it/s]8248it [01:06, 122.79it/s]8261it [01:06, 123.63it/s]8274it [01:06, 123.19it/s]8287it [01:06, 108.65it/s]8299it [01:06, 109.44it/s]8311it [01:06, 108.43it/s]8323it [01:06, 109.61it/s]8339it [01:07, 119.54it/s]8352it [01:07, 121.97it/s]8365it [01:07, 121.96it/s]8378it [01:07, 121.97it/s]8391it [01:07, 121.79it/s]8404it [01:07, 121.93it/s]8418it [01:07, 124.60it/s]8432it [01:07, 126.62it/s]8445it [01:07, 125.21it/s]8459it [01:08, 127.03it/s]8474it [01:08, 130.75it/s]8488it [01:08, 127.39it/s]8492it [01:08, 124.36it/s]
transitions on action 0: 41009
transitions on action 1: 40279
transitions on action 2: 41082
transitions on action 3: 41066
transitions on action 4: 40927
transitions on action 5: 40980
transitions on action 6: 40549
transitions on action 7: 41022
transitions on action 8: 40965
transitions on action 9: 41195
transitions on action 10: 40925
  0%|          | 0/275 [00:00<?, ?it/s]100%|##########| 275/275 [00:00<00:00, 137509.97it/s]
After building MDP:
 NN distance stats: DescribeResult(nobs=465106, minmax=(0.0, 45.09988784790039), mean=15.758665537711705, variance=76.25202583367862, skewness=-0.14875452240940706, kurtosis=-1.0793036057632395), 
 max distance: DescribeResult(nobs=93021, minmax=(0.0, 43.47412872314453), mean=16.580719935933868, variance=76.28829514964438, skewness=-0.15563489449178583, kurtosis=-1.0836914854309032), 
 NN reward stats: 1.8721930597011265 +- 1.7106063678166423 and DescribeResult(nobs=465106, minmax=(-19.936476882850535, 43.0), mean=1.830033785922764, variance=13.44477109286189, skewness=0.967069891346299, kurtosis=2.3363838897234075)
  0%|          | 0/11 [00:00<?, ?it/s]100%|##########| 11/11 [00:00<00:00, 229.18it/s]
  0%|          | 0/1 [00:00<?, ?it/s]                                       0%|          | 0/1 [00:32<?, ?it/s]100%|##########| 1/1 [00:32<00:00, 32.71s/it]100%|##########| 1/1 [00:32<00:00, 32.72s/it]
C:\Users\hamza\AppData\Roaming\Python\Python39\site-packages\gym\utils\seeding.py:63: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
  deprecation(
VI iter = 241, time taken = 0.23430609703063965
Reset start hour to 15 and day to 2
Traceback (most recent call last):
  File "C:\Users\hamza\Documents\ADAC-traffic\run-offline-rl.py", line 578, in <module>
    train_BCQ(env, replay_buffer, is_atari, num_actions, state_dim, device, args, parameters)
  File "C:\Users\hamza\Documents\ADAC-traffic\run-offline-rl.py", line 289, in train_BCQ
    p_returns.append(eval_policy(p, args.env, args.seed, gui=True))
  File "C:\Users\hamza\Documents\ADAC-traffic\run-offline-rl.py", line 438, in eval_policy
    action = policy.select_action(np.array(state), eval=True)
  File "C:\Users\hamza\Documents\ADAC-traffic\ADAC\dac_mdp.py", line 299, in select_action
    nn_indexes, nn_distances = self.nn_indexes[action].topn_nn(state_rep, self.k_pi, self.alpha * self.diameter) if self.nn_mode=='number' else self.nn_indexes[action].topd_nn(state_rep, self.k_pi)
  File "C:\Users\hamza\Documents\ADAC-traffic\ADAC\dac_mdp.py", line 33, in topn_nn
    indexes, distances = self.annoy.get_nns_by_vector(vector, n, include_distances=True)
IndexError: Vector has wrong length (expected 68, got 75)
